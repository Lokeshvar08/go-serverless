<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">
<head th:replace="fragments/header :: head('today\'s menu')">
</head>
<body>
<style>
    .form-body{
      height: 90%;
      padding: 20px;
    }
    .login-card{
      padding: 20px;
      margin: 5%;
    }
    .main{
      height: 100%;
      overflow: hidden;
    }

    .main-content{
      margin-top: 30px;
      margin-bottom: 30px;
      overflow: auto;
    }

    img{
      width: 100%;
      max-height: 100%;
    }

    .card-body{
      display:flex;
      justify-content: center;
      align-items: center;
    }

    .btn-group{
      display:flex;
      justify-content: center;
      align-items: center;
    }

    p{
      margin: 0;
      margin-left: 3px;
      margin-right: 3px;
    }

    add-card{
      padding: 2%;
      display: flex;
      flex-direction: row;
    }
</style>
<style th:replace="fragments/nav :: nav-style"></style>
<div class="main">
  <nav th:replace="fragments/nav :: nav"></nav>
  <div class="container main-content">

      <div class="row gx-5" style="margin-top: 20px;">
        <div class="col-4">
          <table class="table table-hover">
            <thead>
            <tr>
              <th scope="col">S.No</th>
              <th scope="col">item name</th>
              <th scope="col">price</th>
              <th scope="col">action</th>
            </tr>
            </thead>

            <tbody id="list-all-foods">
            <tr class="table-active">
              <th scope="row">1</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>

            <tr class="table-primary">
              <th scope="row">2</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-secondary">
              <th scope="row">3</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-success">
              <th scope="row">4</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-danger">
              <th scope="row">5</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-warning">
              <th scope="row">6</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-info">
              <th scope="row">7</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-light">
              <th scope="row">8</th>
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>

            </tbody>
          </table>
        </div>
        <div class="col-8">
          <table class="table table-hover">
            <thead>
            <tr>

              <th scope="col">S.No</th>
              <th scope="col">item name</th>
              <th scope="col">price</th>
              <th scope="col">action</th>

            </tr>
            </thead>

            <tbody id="menu">

            <tr class="table-active">
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-primary">
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-secondary">
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>
            <tr class="table-success">
              <td>Column content</td>
              <td>Column content</td>
              <td>Column content</td>
            </tr>


            </tbody>
          </table>
        </div>
      </div>

  </div>
</div>
<script>
let orderedFoodItems = [{name: "test1", price: 456, id: 8}];
const onLoadFunc = () => {
  getFoods();
  getOrderedFoods();
}

const getFoods = ()=> {
fetch("http://localhost:8080/api/customer/get-food-items")
    .then(res => res.json())
    .then(res => {
      console.log(res);
      ListFoodsRenderer(res);
    })
    .catch(err => console.log(err))
}

const getOrderedFoods = ()=> {
fetch("http://localhost:8080/api/customer/get-ordered-food-items")
    .then(res => res.json())
    .then(res => {
      console.log(res);
      orderedFoodsRenderer(res);
    })
    .catch(err => console.log(err))
}

window.onload = onLoadFunc

const orderedFoodsRenderer = (res) => {
      console.log("ordered food items renderer");
      const menuItems = res.list;

      document.querySelector("#menu").innerHTML = "";

      let resOutput = "";
      orderedFoodItems.forEach((el, i) => {
        resOutput += `<tr class="table-${i%2==0? 'active': 'secondary'}">
              <th scope="row">${i+1}</th>
              <td>${el.name}</td>
              <td>${el.price}</td>
              <td> <button onclick="modifyFoodItem(${el.id}, false)"class="btn btn-dark">remove</button></td>
            </tr>`
      })

      menuItems.forEach((el, i) => {
        resOutput += `<tr class="table-${i%2==0? 'active': 'secondary'}">
              <th scope="row">${i+1}</th>
              <td>${el.name}</td>
              <td>${el.price}</td>
              <td> <button onclick="modifyFoodItem(${el.id}, false)"class="btn btn-dark">remove</button></td>
            </tr>`
      })

      document.querySelector("#menu").innerHTML = resOutput;
 }

 const ListFoodsRenderer = (res) => {
      console.log("list all renderer");
      const foodItems = res.list;

      console.log(document.querySelector("#list-all-foods"))
      document.querySelector("#list-all-foods").innerHTML = "";

      let resOutput = "";
      foodItems.forEach((el, i) => {
        resOutput += `<tr class="table-${i%2==0? 'active': 'secondary'}">
              <th scope="row">${i+1}</th>
              <td>${el.name}</td>
              <td>${el.price}</td>
              <td> <button onclick="addFoodItem({id: ${el.id}, name: '${el.name}', price: ${el.price}})" class="btn btn-dark">Add</button></td>
            </tr>`
      })

      document.querySelector("#list-all-foods").innerHTML = resOutput;
 }

 const addFoodItem = ({id, name, price}) => {
   console.log(orderedFoodItems)
   orderedFoodItems.push({id: id, name: name, price: price});
   getOrderedFoods();
 }

</script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
</body>
</html>